<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Caminho Fácil - Avaliação</title>

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets/css/additional_styles.css">

		<style>
			body {
				background-color: #f8f9fa;
			}

			/* estrelas */
			.star-rating {
				display: flex;
				gap: 5px;
				font-size: 2rem;
				color: #ccc;
				cursor: pointer;
				justify-content: center;
			}
			.star.active {
				color: gold;
			}

			/* switches */
			.form-switch {
				background: white;
				border-radius: 10px;
				padding: 10px 15px;
				display: flex;
				align-items: center;
				justify-content: space-between;
				box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
				margin-bottom: 8px;
			}

			.alert {
				display: none;
			}

			.logoBox {
				background-color: white;
				border-radius: 0 8px 8px 0;
				padding: 5px 10px;
				box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
				display: inline-block;
			}

			.logoImg {
				height: 30px;
				display: block;
			}

			.navbar {
				padding-top: 0.5rem;
				padding-bottom: 0.5rem;
			}
		</style>
	</head>

	<link rel="icon" type="image/png" href="assets/img/favicon.png" />

	<body>
		<nav class="navbar navbar-dark bg-success fixed-top position-relative">
			<div class="container-fluid d-flex align-items-center justify-content-between">
				<a class="navbar-brand text-white ms-5" href="#" style="padding-left: 50px" id="btnVoltar">← Voltar</a>
				<span class="navbar-text text-white me-3">Avaliar Calçada</span>
				<div class="me-3">
					<p style="color: white; display: inline-block;" class="tamanho_fonte"> tamanho fonte</p>
					<button class="btn btn-light btn-sm" id="fontPlus">A+</button>
					<button class="btn btn-light btn-sm" id="fontMinus">A-</button>
				</div>
			</div>

			<!-- Logo placed *below* the navbar, but visually overlapping -->
			<a href="index.html">
				<div class="logoBox position-absolute" style="top: 100%; left: 0; transform: translateY(-40%); z-index: 1">
					<img class="logoImg" src="assets/img/logoCF.png" alt="Logo Caminho Fácil" alt="logo caminho fácil"/>
				</div>
			</a>
		</nav>

		<h3 class="funcionalidade_titulo">
			<img src="assets/img/avaliar.png" class="icone_titulo" alt="icone avaliação">
			Avaliação
			<button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="tooltip" data-bs-placement="right" 
			title="Avaliação da calçada selecionada. Em estrelas, com comentário e upload de imagens." id="info_button">i
			</button>
		</h3>
		<hr class="hr_style">

		<div class="container mt-5 pt-4" id="avaliacao_box">
			<form id="avaliacaoForm">
				<!-- Estrelas -->
				<div class="mb-4 text-center">
					<div class="mb-2">
						<div id="rating-label" class="star-rating-text">Escolha uma nota</div>
					</div>
					<div id="stars" class="star-rating">
						<span class="star" data-value="1">★</span>
						<span class="star" data-value="2">★</span>
						<span class="star" data-value="3">★</span>
						<span class="star" data-value="4">★</span>
						<span class="star" data-value="5">★</span>
					</div>
					<input type="hidden" id="nota" value="0" />
				</div>

				<!-- Comentário -->
				<div class="mb-3">
					<label class="form-label fw-bold">Comentário</label>
					<button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="tooltip" data-bs-placement="right" 
					title="Descreva informações que julgue como pertinentes para a calçada que está avaliando." id="info_button">i
					</button>
					<textarea id="comentario" class="form-control" rows="3" placeholder="Escreva aqui seu comentário..."></textarea>
				</div>

				<!-- Detalhes -->
				<div class="mb-4">
					<label class="form-label fw-bold">Detalhes</label>
					<button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="tooltip" data-bs-placement="right" 
					title="Detalhes de acessabilidade gerais para marcar se são atendidos pela calçada ou não." id="info_button">i
					</button>

					<div class="form-switch">
						<label for="cadeirante">Adequado para cadeira de rodas?</label>
						<input class="form-check-input" type="checkbox" id="cadeirante" checked />
					</div>

					<div class="form-switch">
						<label for="bebe">Adequado para carrinhos de bebê?</label>
						<input class="form-check-input" type="checkbox" id="bebe" checked />
					</div>

					<div class="form-switch">
						<label for="idosos">Adequado para idosos?</label>
						<input class="form-check-input" type="checkbox" id="idosos" checked />
					</div>

					<div class="form-switch">
						<label for="tatil">Presença de piso tátil</label>
						<input class="form-check-input" type="checkbox" id="tatil" checked />
					</div>

					<div class="form-switch">
						<label for="rebaixamento">Rebaixamento de guia</label>
						<input class="form-check-input" type="checkbox" id="rebaixamento" checked />
					</div>

					<div class="form-switch">
						<label for="obstaculos">Calçada livre de obstáculos</label>
						<input class="form-check-input" type="checkbox" id="obstaculos" checked />
					</div>

					<div class="form-switch">
						<label for="iluminacao">Iluminação noturna</label>
						<input class="form-check-input" type="checkbox" id="iluminacao" checked />
					</div>
				</div>

				<!-- Foto -->
				<div class="mb-3">
					<label class="form-label fw-bold">Foto (opcional)</label>
					<button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="tooltip" data-bs-placement="right" 
					title="Upload de foto da calçada sendo avaliada. Recomenda-se postar foto do problema localizado." id="info_button">i
					</button>
					<input type="file" class="form-control" id="foto" />
				</div>

				<!-- Alertas -->
				<div class="alert alert-danger" id="alertErro">⚠️ Preencha a nota e o comentário antes de enviar.</div>
				<div class="alert alert-success text-center" id="alertSucesso">
					✅ Avaliação enviada com sucesso! <br />
					<button type="button" id="btnVoltarSucesso" class="btn btn-outline-success mt-2">Voltar aos detalhes</button>
				</div>

				<!-- Botão Enviar -->
				<div class="d-grid mt-4">
					<button type="submit" class="btn btn-primary" id="botao_enviar_avaliacao">Enviar avaliação</button>
				</div>
			</form>
		</div>
	</body>

	<!-- atualiza botoes de voltar dinamicamente -->
		<script>
			document.addEventListener("DOMContentLoaded", () => {
				const rua = localStorage.getItem("ruaSelecionada");

				const btnVoltar = document.getElementById("btnVoltar");
				if (btnVoltar) {
					btnVoltar.href = rua ? `detalhes.html?rua=${encodeURIComponent(rua)}` : "index.html";
				}

				const btnVoltarSucesso = document.getElementById("btnVoltarSucesso");
				if (btnVoltarSucesso) {
					btnVoltarSucesso.addEventListener("click", () => {
						window.location.href = rua ? `detalhes.html?rua=${encodeURIComponent(rua)}` : "index.html";
					});
				}
			});
		</script>

		<script>
			const stars = document.querySelectorAll(".star");
			const notaInput = document.getElementById("nota");
			const alertErro = document.getElementById("alertErro");
			const alertSucesso = document.getElementById("alertSucesso");
			const form = document.getElementById("avaliacaoForm");

			// controle de estrelas
			const ratingLabel = document.getElementById("rating-label");
			const labels = ["Péssimo", "Ruim", "Regular", "Bom", "Excelente"];

			stars.forEach((star) => {
				star.addEventListener("click", () => {
					const value = parseInt(star.dataset.value);
					notaInput.value = value;
					stars.forEach((s) => {
						s.classList.toggle("active", parseInt(s.dataset.value) <= value);
					});
					ratingLabel.textContent = labels[value - 1];
				});
			});
		</script>
		<script>
			let fontSize = 16;

			document.getElementById("fontPlus").addEventListener("click", () => {
				fontSize = Math.min(fontSize + 2, 28); 
				document.documentElement.style.fontSize = fontSize + "px";
			});

			document.getElementById("fontMinus").addEventListener("click", () => {
				fontSize = Math.max(fontSize - 2, 10); 
				document.documentElement.style.fontSize = fontSize + "px";
			});
		</script>
</html>
